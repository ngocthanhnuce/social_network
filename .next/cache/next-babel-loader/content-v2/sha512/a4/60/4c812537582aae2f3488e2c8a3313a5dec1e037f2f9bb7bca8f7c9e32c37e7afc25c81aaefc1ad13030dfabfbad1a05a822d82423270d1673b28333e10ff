{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Admin/Documents/social/social_network/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Admin/Documents/social/social_network/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Users/Admin/Documents/social/social_network/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\social\\\\social_network\\\\components\\\\Post\\\\CreatePost.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useRef } from \"react\";\nimport { Form, Button, Image, Divider, Message, Icon } from \"semantic-ui-react\";\nimport uploadPic from \"../../utils/uploadPicToCloudinary\";\nimport { submitNewPost } from \"../../utils/postActions\";\nimport CropImageModal from \"./CropImageModal\";\n\nfunction CreatePost(_ref) {\n  _s();\n\n  var user = _ref.user,\n      setPosts = _ref.setPosts;\n\n  var _useState = useState({\n    text: \"\",\n    location: \"\"\n  }),\n      newPost = _useState[0],\n      setNewPost = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var inputRef = useRef();\n\n  var _useState3 = useState(null),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var _useState4 = useState(false),\n      highlighted = _useState4[0],\n      setHighlighted = _useState4[1];\n\n  var _useState5 = useState(null),\n      media = _useState5[0],\n      setMedia = _useState5[1];\n\n  var _useState6 = useState(null),\n      mediaPreview = _useState6[0],\n      setMediaPreview = _useState6[1];\n\n  var _useState7 = useState(false),\n      showModal = _useState7[0],\n      setShowModal = _useState7[1];\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value,\n        files = _e$target.files;\n\n    if (name === \"media\") {\n      if (files && files.length > 0) {\n        setMedia(files[0]);\n        setMediaPreview(URL.createObjectURL(files[0]));\n      }\n    }\n\n    setNewPost(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, _defineProperty({}, name, value));\n    });\n  };\n\n  var addStyles = function addStyles() {\n    return {\n      textAlign: \"center\",\n      height: \"150px\",\n      width: \"150px\",\n      border: \"dotted\",\n      paddingTop: media === null && \"60px\",\n      cursor: \"pointer\",\n      borderColor: highlighted ? \"green\" : \"black\"\n    };\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var picUrl;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n\n              if (!(media !== null)) {\n                _context.next = 9;\n                break;\n              }\n\n              _context.next = 5;\n              return uploadPic(media);\n\n            case 5:\n              picUrl = _context.sent;\n\n              if (picUrl) {\n                _context.next = 9;\n                break;\n              }\n\n              setLoading(false);\n              return _context.abrupt(\"return\", setError(\"Error Uploading Image\"));\n\n            case 9:\n              _context.next = 11;\n              return submitNewPost(newPost.text, newPost.location, picUrl, setPosts, setNewPost, setError);\n\n            case 11:\n              setMedia(null);\n              mediaPreview && URL.revokeObjectURL(mediaPreview);\n              setTimeout(function () {\n                return setMediaPreview(null);\n              }, 3000);\n              setLoading(false);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, showModal && __jsx(CropImageModal, {\n    mediaPreview: mediaPreview,\n    setMedia: setMedia,\n    showModal: showModal,\n    setShowModal: setShowModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }), __jsx(Form, {\n    error: error !== null,\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }\n  }, __jsx(Message, {\n    error: true,\n    onDismiss: function onDismiss() {\n      return setError(null);\n    },\n    content: error,\n    header: \"Oops!\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }), __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, __jsx(Image, {\n    src: user.profilePicUrl,\n    circular: true,\n    avatar: true,\n    inline: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }), __jsx(Form.TextArea, {\n    placeholder: \"Whats Happening\",\n    name: \"text\",\n    value: newPost.text,\n    onChange: handleChange,\n    rows: 4,\n    width: 14,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  })), __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Input, {\n    value: newPost.location,\n    name: \"location\",\n    onChange: handleChange,\n    label: \"Add Location\",\n    icon: \"map marker alternate\",\n    placeholder: \"Want to add Location?\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }), __jsx(\"input\", {\n    ref: inputRef,\n    onChange: handleChange,\n    name: \"media\",\n    style: {\n      display: \"none\"\n    },\n    type: \"file\",\n    accept: \"image/*\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    onClick: function onClick() {\n      return inputRef.current.click();\n    },\n    style: addStyles(),\n    onDragOver: function onDragOver(e) {\n      e.preventDefault();\n      setHighlighted(true);\n    },\n    onDragLeave: function onDragLeave(e) {\n      e.preventDefault();\n      setHighlighted(false);\n    },\n    onDrop: function onDrop(e) {\n      e.preventDefault();\n      setHighlighted(true);\n      var droppedFile = Array.from(e.dataTransfer.files);\n      setMedia(droppedFile[0]);\n      setMediaPreview(URL.createObjectURL(droppedFile[0]));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }\n  }, media === null ? __jsx(Icon, {\n    name: \"plus\",\n    size: \"big\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }) : __jsx(Image, {\n    style: {\n      height: \"150px\",\n      width: \"150px\"\n    },\n    src: mediaPreview,\n    alt: \"PostImage\",\n    centered: true,\n    size: \"medium\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  })), mediaPreview !== null && __jsx(React.Fragment, null, __jsx(Divider, {\n    hidden: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }), __jsx(Button, {\n    content: \"Crop Image\",\n    type: \"button\",\n    primary: true,\n    circular: true,\n    onClick: function onClick() {\n      return setShowModal(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  })), __jsx(Divider, {\n    hidden: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    circular: true,\n    disabled: newPost.text === \"\" || loading,\n    content: __jsx(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 20\n      }\n    }, \"Post\"),\n    style: {\n      backgroundColor: \"#1DA1F2\",\n      color: \"white\"\n    },\n    icon: \"send\",\n    loading: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  })), __jsx(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }\n  }));\n}\n\n_s(CreatePost, \"V2grMXhPNOQKoVKa8EbIYcN7ERU=\");\n\n_c = CreatePost;\nexport default CreatePost;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePost\");","map":{"version":3,"sources":["C:/Users/Admin/Documents/social/social_network/components/Post/CreatePost.js"],"names":["React","useState","useRef","Form","Button","Image","Divider","Message","Icon","uploadPic","submitNewPost","CropImageModal","CreatePost","user","setPosts","text","location","newPost","setNewPost","loading","setLoading","inputRef","error","setError","highlighted","setHighlighted","media","setMedia","mediaPreview","setMediaPreview","showModal","setShowModal","handleChange","e","target","name","value","files","length","URL","createObjectURL","prev","addStyles","textAlign","height","width","border","paddingTop","cursor","borderColor","handleSubmit","preventDefault","picUrl","revokeObjectURL","setTimeout","profilePicUrl","display","current","click","droppedFile","Array","from","dataTransfer","backgroundColor","color"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,QAAwC,OAAxC;AACA,SAASC,IAAT,EAAeC,MAAf,EAAuBC,KAAvB,EAA8BC,OAA9B,EAAuCC,OAAvC,EAAgDC,IAAhD,QAA4D,mBAA5D;AACA,OAAOC,SAAP,MAAsB,mCAAtB;AACA,SAASC,aAAT,QAA8B,yBAA9B;AACA,OAAOC,cAAP,MAA2B,kBAA3B;;AAEA,SAASC,UAAT,OAAwC;AAAA;;AAAA,MAAlBC,IAAkB,QAAlBA,IAAkB;AAAA,MAAZC,QAAY,QAAZA,QAAY;;AAAA,kBACRb,QAAQ,CAAC;AAAEc,IAAAA,IAAI,EAAE,EAAR;AAAYC,IAAAA,QAAQ,EAAE;AAAtB,GAAD,CADA;AAAA,MAC/BC,OAD+B;AAAA,MACtBC,UADsB;;AAAA,mBAERjB,QAAQ,CAAC,KAAD,CAFA;AAAA,MAE/BkB,OAF+B;AAAA,MAEtBC,UAFsB;;AAGtC,MAAMC,QAAQ,GAAGnB,MAAM,EAAvB;;AAHsC,mBAKZD,QAAQ,CAAC,IAAD,CALI;AAAA,MAK/BqB,KAL+B;AAAA,MAKxBC,QALwB;;AAAA,mBAMAtB,QAAQ,CAAC,KAAD,CANR;AAAA,MAM/BuB,WAN+B;AAAA,MAMlBC,cANkB;;AAAA,mBAQZxB,QAAQ,CAAC,IAAD,CARI;AAAA,MAQ/ByB,KAR+B;AAAA,MAQxBC,QARwB;;AAAA,mBASE1B,QAAQ,CAAC,IAAD,CATV;AAAA,MAS/B2B,YAT+B;AAAA,MASjBC,eATiB;;AAAA,mBAWJ5B,QAAQ,CAAC,KAAD,CAXJ;AAAA,MAW/B6B,SAX+B;AAAA,MAWpBC,YAXoB;;AAatC,MAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,CAAC,EAAI;AAAA,oBACOA,CAAC,CAACC,MADT;AAAA,QAChBC,IADgB,aAChBA,IADgB;AAAA,QACVC,KADU,aACVA,KADU;AAAA,QACHC,KADG,aACHA,KADG;;AAGxB,QAAIF,IAAI,KAAK,OAAb,EAAsB;AACpB,UAAIE,KAAK,IAAIA,KAAK,CAACC,MAAN,GAAe,CAA5B,EAA+B;AAC7BX,QAAAA,QAAQ,CAACU,KAAK,CAAC,CAAD,CAAN,CAAR;AACAR,QAAAA,eAAe,CAACU,GAAG,CAACC,eAAJ,CAAoBH,KAAK,CAAC,CAAD,CAAzB,CAAD,CAAf;AACD;AACF;;AAEDnB,IAAAA,UAAU,CAAC,UAAAuB,IAAI;AAAA,6CAAUA,IAAV,2BAAiBN,IAAjB,EAAwBC,KAAxB;AAAA,KAAL,CAAV;AACD,GAXD;;AAaA,MAAMM,SAAS,GAAG,SAAZA,SAAY;AAAA,WAAO;AACvBC,MAAAA,SAAS,EAAE,QADY;AAEvBC,MAAAA,MAAM,EAAE,OAFe;AAGvBC,MAAAA,KAAK,EAAE,OAHgB;AAIvBC,MAAAA,MAAM,EAAE,QAJe;AAKvBC,MAAAA,UAAU,EAAErB,KAAK,KAAK,IAAV,IAAkB,MALP;AAMvBsB,MAAAA,MAAM,EAAE,SANe;AAOvBC,MAAAA,WAAW,EAAEzB,WAAW,GAAG,OAAH,GAAa;AAPd,KAAP;AAAA,GAAlB;;AAUA,MAAM0B,YAAY;AAAA,yEAAG,iBAAMjB,CAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACnBA,cAAAA,CAAC,CAACkB,cAAF;AACA/B,cAAAA,UAAU,CAAC,IAAD,CAAV;;AAFmB,oBAKfM,KAAK,KAAK,IALK;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAMFjB,SAAS,CAACiB,KAAD,CANP;;AAAA;AAMjB0B,cAAAA,MANiB;;AAAA,kBAOZA,MAPY;AAAA;AAAA;AAAA;;AAQfhC,cAAAA,UAAU,CAAC,KAAD,CAAV;AARe,+CASRG,QAAQ,CAAC,uBAAD,CATA;;AAAA;AAAA;AAAA,qBAabb,aAAa,CACjBO,OAAO,CAACF,IADS,EAEjBE,OAAO,CAACD,QAFS,EAGjBoC,MAHiB,EAIjBtC,QAJiB,EAKjBI,UALiB,EAMjBK,QANiB,CAbA;;AAAA;AAsBnBI,cAAAA,QAAQ,CAAC,IAAD,CAAR;AACAC,cAAAA,YAAY,IAAIW,GAAG,CAACc,eAAJ,CAAoBzB,YAApB,CAAhB;AACA0B,cAAAA,UAAU,CAAC;AAAA,uBAAMzB,eAAe,CAAC,IAAD,CAArB;AAAA,eAAD,EAA8B,IAA9B,CAAV;AACAT,cAAAA,UAAU,CAAC,KAAD,CAAV;;AAzBmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZ8B,YAAY;AAAA;AAAA;AAAA,KAAlB;;AA4BA,SACE,4BACGpB,SAAS,IACR,MAAC,cAAD;AACE,IAAA,YAAY,EAAEF,YADhB;AAEE,IAAA,QAAQ,EAAED,QAFZ;AAGE,IAAA,SAAS,EAAEG,SAHb;AAIE,IAAA,YAAY,EAAEC,YAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAUE,MAAC,IAAD;AAAM,IAAA,KAAK,EAAET,KAAK,KAAK,IAAvB;AAA6B,IAAA,QAAQ,EAAE4B,YAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,OAAD;AACE,IAAA,KAAK,MADP;AAEE,IAAA,SAAS,EAAE;AAAA,aAAM3B,QAAQ,CAAC,IAAD,CAAd;AAAA,KAFb;AAGE,IAAA,OAAO,EAAED,KAHX;AAIE,IAAA,MAAM,EAAC,OAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAQE,MAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,KAAD;AAAO,IAAA,GAAG,EAAET,IAAI,CAAC0C,aAAjB;AAAgC,IAAA,QAAQ,MAAxC;AAAyC,IAAA,MAAM,MAA/C;AAAgD,IAAA,MAAM,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,IAAD,CAAM,QAAN;AACE,IAAA,WAAW,EAAC,iBADd;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,KAAK,EAAEtC,OAAO,CAACF,IAHjB;AAIE,IAAA,QAAQ,EAAEiB,YAJZ;AAKE,IAAA,IAAI,EAAE,CALR;AAME,IAAA,KAAK,EAAE,EANT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CARF,EAoBE,MAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD,CAAM,KAAN;AACE,IAAA,KAAK,EAAEf,OAAO,CAACD,QADjB;AAEE,IAAA,IAAI,EAAC,UAFP;AAGE,IAAA,QAAQ,EAAEgB,YAHZ;AAIE,IAAA,KAAK,EAAC,cAJR;AAKE,IAAA,IAAI,EAAC,sBALP;AAME,IAAA,WAAW,EAAC,uBANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAUE;AACE,IAAA,GAAG,EAAEX,QADP;AAEE,IAAA,QAAQ,EAAEW,YAFZ;AAGE,IAAA,IAAI,EAAC,OAHP;AAIE,IAAA,KAAK,EAAE;AAAEwB,MAAAA,OAAO,EAAE;AAAX,KAJT;AAKE,IAAA,IAAI,EAAC,MALP;AAME,IAAA,MAAM,EAAC,SANT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVF,CApBF,EAwCE;AACE,IAAA,OAAO,EAAE;AAAA,aAAMnC,QAAQ,CAACoC,OAAT,CAAiBC,KAAjB,EAAN;AAAA,KADX;AAEE,IAAA,KAAK,EAAEhB,SAAS,EAFlB;AAGE,IAAA,UAAU,EAAE,oBAAAT,CAAC,EAAI;AACfA,MAAAA,CAAC,CAACkB,cAAF;AACA1B,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD,KANH;AAOE,IAAA,WAAW,EAAE,qBAAAQ,CAAC,EAAI;AAChBA,MAAAA,CAAC,CAACkB,cAAF;AACA1B,MAAAA,cAAc,CAAC,KAAD,CAAd;AACD,KAVH;AAWE,IAAA,MAAM,EAAE,gBAAAQ,CAAC,EAAI;AACXA,MAAAA,CAAC,CAACkB,cAAF;AACA1B,MAAAA,cAAc,CAAC,IAAD,CAAd;AAEA,UAAMkC,WAAW,GAAGC,KAAK,CAACC,IAAN,CAAW5B,CAAC,CAAC6B,YAAF,CAAezB,KAA1B,CAApB;AAEAV,MAAAA,QAAQ,CAACgC,WAAW,CAAC,CAAD,CAAZ,CAAR;AACA9B,MAAAA,eAAe,CAACU,GAAG,CAACC,eAAJ,CAAoBmB,WAAW,CAAC,CAAD,CAA/B,CAAD,CAAf;AACD,KAnBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAqBGjC,KAAK,KAAK,IAAV,GACC,MAAC,IAAD;AAAM,IAAA,IAAI,EAAC,MAAX;AAAkB,IAAA,IAAI,EAAC,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,GAGC,MAAC,KAAD;AACE,IAAA,KAAK,EAAE;AAAEkB,MAAAA,MAAM,EAAE,OAAV;AAAmBC,MAAAA,KAAK,EAAE;AAA1B,KADT;AAEE,IAAA,GAAG,EAAEjB,YAFP;AAGE,IAAA,GAAG,EAAC,WAHN;AAIE,IAAA,QAAQ,MAJV;AAKE,IAAA,IAAI,EAAC,QALP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxBJ,CAxCF,EA0EGA,YAAY,KAAK,IAAjB,IACC,4BACE,MAAC,OAAD;AAAS,IAAA,MAAM,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAGE,MAAC,MAAD;AACE,IAAA,OAAO,EAAC,YADV;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,OAAO,MAHT;AAIE,IAAA,QAAQ,MAJV;AAKE,IAAA,OAAO,EAAE;AAAA,aAAMG,YAAY,CAAC,IAAD,CAAlB;AAAA,KALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CA3EJ,EAwFE,MAAC,OAAD;AAAS,IAAA,MAAM,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxFF,EA0FE,MAAC,MAAD;AACE,IAAA,QAAQ,MADV;AAEE,IAAA,QAAQ,EAAEd,OAAO,CAACF,IAAR,KAAiB,EAAjB,IAAuBI,OAFnC;AAGE,IAAA,OAAO,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAHX;AAIE,IAAA,KAAK,EAAE;AAAE4C,MAAAA,eAAe,EAAE,SAAnB;AAA8BC,MAAAA,KAAK,EAAE;AAArC,KAJT;AAKE,IAAA,IAAI,EAAC,MALP;AAME,IAAA,OAAO,EAAE7C,OANX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA1FF,CAVF,EA6GE,MAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7GF,CADF;AAiHD;;GAjLQP,U;;KAAAA,U;AAmLT,eAAeA,UAAf","sourcesContent":["import React, { useState, useRef } from \"react\";\nimport { Form, Button, Image, Divider, Message, Icon } from \"semantic-ui-react\";\nimport uploadPic from \"../../utils/uploadPicToCloudinary\";\nimport { submitNewPost } from \"../../utils/postActions\";\nimport CropImageModal from \"./CropImageModal\";\n\nfunction CreatePost({ user, setPosts }) {\n  const [newPost, setNewPost] = useState({ text: \"\", location: \"\" });\n  const [loading, setLoading] = useState(false);\n  const inputRef = useRef();\n\n  const [error, setError] = useState(null);\n  const [highlighted, setHighlighted] = useState(false);\n\n  const [media, setMedia] = useState(null);\n  const [mediaPreview, setMediaPreview] = useState(null);\n\n  const [showModal, setShowModal] = useState(false);\n\n  const handleChange = e => {\n    const { name, value, files } = e.target;\n\n    if (name === \"media\") {\n      if (files && files.length > 0) {\n        setMedia(files[0]);\n        setMediaPreview(URL.createObjectURL(files[0]));\n      }\n    }\n\n    setNewPost(prev => ({ ...prev, [name]: value }));\n  };\n\n  const addStyles = () => ({\n    textAlign: \"center\",\n    height: \"150px\",\n    width: \"150px\",\n    border: \"dotted\",\n    paddingTop: media === null && \"60px\",\n    cursor: \"pointer\",\n    borderColor: highlighted ? \"green\" : \"black\"\n  });\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    let picUrl;\n\n    if (media !== null) {\n      picUrl = await uploadPic(media);\n      if (!picUrl) {\n        setLoading(false);\n        return setError(\"Error Uploading Image\");\n      }\n    }\n\n    await submitNewPost(\n      newPost.text,\n      newPost.location,\n      picUrl,\n      setPosts,\n      setNewPost,\n      setError\n    );\n\n    setMedia(null);\n    mediaPreview && URL.revokeObjectURL(mediaPreview);\n    setTimeout(() => setMediaPreview(null), 3000);\n    setLoading(false);\n  };\n\n  return (\n    <>\n      {showModal && (\n        <CropImageModal\n          mediaPreview={mediaPreview}\n          setMedia={setMedia}\n          showModal={showModal}\n          setShowModal={setShowModal}\n        />\n      )}\n\n      <Form error={error !== null} onSubmit={handleSubmit}>\n        <Message\n          error\n          onDismiss={() => setError(null)}\n          content={error}\n          header=\"Oops!\"\n        />\n\n        <Form.Group>\n          <Image src={user.profilePicUrl} circular avatar inline />\n          <Form.TextArea\n            placeholder=\"Whats Happening\"\n            name=\"text\"\n            value={newPost.text}\n            onChange={handleChange}\n            rows={4}\n            width={14}\n          />\n        </Form.Group>\n\n        <Form.Group>\n          <Form.Input\n            value={newPost.location}\n            name=\"location\"\n            onChange={handleChange}\n            label=\"Add Location\"\n            icon=\"map marker alternate\"\n            placeholder=\"Want to add Location?\"\n          />\n\n          <input\n            ref={inputRef}\n            onChange={handleChange}\n            name=\"media\"\n            style={{ display: \"none\" }}\n            type=\"file\"\n            accept=\"image/*\"\n          />\n        </Form.Group>\n\n        <div\n          onClick={() => inputRef.current.click()}\n          style={addStyles()}\n          onDragOver={e => {\n            e.preventDefault();\n            setHighlighted(true);\n          }}\n          onDragLeave={e => {\n            e.preventDefault();\n            setHighlighted(false);\n          }}\n          onDrop={e => {\n            e.preventDefault();\n            setHighlighted(true);\n\n            const droppedFile = Array.from(e.dataTransfer.files);\n\n            setMedia(droppedFile[0]);\n            setMediaPreview(URL.createObjectURL(droppedFile[0]));\n          }}\n        >\n          {media === null ? (\n            <Icon name=\"plus\" size=\"big\" />\n          ) : (\n            <Image\n              style={{ height: \"150px\", width: \"150px\" }}\n              src={mediaPreview}\n              alt=\"PostImage\"\n              centered\n              size=\"medium\"\n            />\n          )}\n        </div>\n\n        {mediaPreview !== null && (\n          <>\n            <Divider hidden />\n\n            <Button\n              content=\"Crop Image\"\n              type=\"button\"\n              primary\n              circular\n              onClick={() => setShowModal(true)}\n            />\n          </>\n        )}\n\n        <Divider hidden />\n\n        <Button\n          circular\n          disabled={newPost.text === \"\" || loading}\n          content={<strong>Post</strong>}\n          style={{ backgroundColor: \"#1DA1F2\", color: \"white\" }}\n          icon=\"send\"\n          loading={loading}\n        />\n      </Form>\n      <Divider />\n    </>\n  );\n}\n\nexport default CreatePost;\n"]},"metadata":{},"sourceType":"module"}