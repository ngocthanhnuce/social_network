{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\social\\\\social_network\\\\pages\\\\_app.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport axios from \"axios\";\nimport { parseCookies, destroyCookie } from \"nookies\";\nimport baseUrl from \"../utils/baseUrl\";\nimport { redirectUser } from \"../utils/authUser\";\nimport Layout from \"../components/Layout/Layout\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"semantic-ui-css/semantic.min.css\";\nimport \"cropperjs/dist/cropper.css\";\n\nfunction MyApp({\n  Component,\n  pageProps\n}) {\n  return __jsx(Layout, _extends({}, pageProps, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 5\n    }\n  }), __jsx(Component, _extends({}, pageProps, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 7\n    }\n  })));\n}\n\nMyApp.getInitialProps = async ({\n  Component,\n  ctx\n}) => {\n  const {\n    token\n  } = parseCookies(ctx);\n  let pageProps = {};\n  const protectedRoutes = ctx.pathname === \"/\" || ctx.pathname === \"/[username]\" || ctx.pathname === \"/notifications\" || ctx.pathname === \"/post/[postId]\" || ctx.pathname === \"/messages\" || ctx.pathname === \"/search\";\n\n  if (!token) {\n    destroyCookie(ctx, \"token\");\n    protectedRoutes && redirectUser(ctx, \"/login\");\n  } //\n  else {\n      if (Component.getInitialProps) {\n        pageProps = await Component.getInitialProps(ctx);\n      }\n\n      try {\n        const res = await axios.get(`${baseUrl}/api/auth`, {\n          headers: {\n            Authorization: token\n          }\n        });\n        const {\n          user,\n          userFollowStats\n        } = res.data;\n        if (user) !protectedRoutes && redirectUser(ctx, \"/\");\n        pageProps.user = user;\n        pageProps.userFollowStats = userFollowStats;\n      } catch (error) {\n        destroyCookie(ctx, \"token\");\n        redirectUser(ctx, \"/login\");\n      }\n    }\n\n  return {\n    pageProps\n  };\n};\n\nexport default MyApp;","map":{"version":3,"sources":["C:/Users/Admin/Documents/social/social_network/pages/_app.js"],"names":["axios","parseCookies","destroyCookie","baseUrl","redirectUser","Layout","MyApp","Component","pageProps","getInitialProps","ctx","token","protectedRoutes","pathname","res","get","headers","Authorization","user","userFollowStats","data","error"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,EAAuBC,aAAvB,QAA4C,SAA5C;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,OAAOC,MAAP,MAAmB,6BAAnB;AACA,OAAO,uCAAP;AACA,OAAO,kCAAP;AACA,OAAO,4BAAP;;AAEA,SAASC,KAAT,CAAe;AAAEC,EAAAA,SAAF;AAAaC,EAAAA;AAAb,CAAf,EAAyC;AACvC,SACE,MAAC,MAAD,eAAYA,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MACE,MAAC,SAAD,eAAeA,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADF,CADF;AAKD;;AAEDF,KAAK,CAACG,eAAN,GAAwB,OAAO;AAAEF,EAAAA,SAAF;AAAaG,EAAAA;AAAb,CAAP,KAA8B;AACpD,QAAM;AAAEC,IAAAA;AAAF,MAAYV,YAAY,CAACS,GAAD,CAA9B;AACA,MAAIF,SAAS,GAAG,EAAhB;AAEA,QAAMI,eAAe,GACnBF,GAAG,CAACG,QAAJ,KAAiB,GAAjB,IACAH,GAAG,CAACG,QAAJ,KAAiB,aADjB,IAEAH,GAAG,CAACG,QAAJ,KAAiB,gBAFjB,IAGAH,GAAG,CAACG,QAAJ,KAAiB,gBAHjB,IAIAH,GAAG,CAACG,QAAJ,KAAiB,WAJjB,IAKAH,GAAG,CAACG,QAAJ,KAAiB,SANnB;;AAQA,MAAI,CAACF,KAAL,EAAY;AACVT,IAAAA,aAAa,CAACQ,GAAD,EAAM,OAAN,CAAb;AACAE,IAAAA,eAAe,IAAIR,YAAY,CAACM,GAAD,EAAM,QAAN,CAA/B;AACD,GAHD,CAIA;AAJA,OAKK;AACH,UAAIH,SAAS,CAACE,eAAd,EAA+B;AAC7BD,QAAAA,SAAS,GAAG,MAAMD,SAAS,CAACE,eAAV,CAA0BC,GAA1B,CAAlB;AACD;;AAED,UAAI;AACF,cAAMI,GAAG,GAAG,MAAMd,KAAK,CAACe,GAAN,CAAW,GAAEZ,OAAQ,WAArB,EAAiC;AACjDa,UAAAA,OAAO,EAAE;AAAEC,YAAAA,aAAa,EAAEN;AAAjB;AADwC,SAAjC,CAAlB;AAIA,cAAM;AAAEO,UAAAA,IAAF;AAAQC,UAAAA;AAAR,YAA4BL,GAAG,CAACM,IAAtC;AAEA,YAAIF,IAAJ,EAAU,CAACN,eAAD,IAAoBR,YAAY,CAACM,GAAD,EAAM,GAAN,CAAhC;AAEVF,QAAAA,SAAS,CAACU,IAAV,GAAiBA,IAAjB;AACAV,QAAAA,SAAS,CAACW,eAAV,GAA4BA,eAA5B;AACD,OAXD,CAWE,OAAOE,KAAP,EAAc;AACdnB,QAAAA,aAAa,CAACQ,GAAD,EAAM,OAAN,CAAb;AACAN,QAAAA,YAAY,CAACM,GAAD,EAAM,QAAN,CAAZ;AACD;AACF;;AAED,SAAO;AAAEF,IAAAA;AAAF,GAAP;AACD,CAxCD;;AA0CA,eAAeF,KAAf","sourcesContent":["import axios from \"axios\";\nimport { parseCookies, destroyCookie } from \"nookies\";\nimport baseUrl from \"../utils/baseUrl\";\nimport { redirectUser } from \"../utils/authUser\";\nimport Layout from \"../components/Layout/Layout\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"semantic-ui-css/semantic.min.css\";\nimport \"cropperjs/dist/cropper.css\";\n\nfunction MyApp({ Component, pageProps }) {\n  return (\n    <Layout {...pageProps}>\n      <Component {...pageProps} />\n    </Layout>\n  );\n}\n\nMyApp.getInitialProps = async ({ Component, ctx }) => {\n  const { token } = parseCookies(ctx);\n  let pageProps = {};\n\n  const protectedRoutes =\n    ctx.pathname === \"/\" ||\n    ctx.pathname === \"/[username]\" ||\n    ctx.pathname === \"/notifications\" ||\n    ctx.pathname === \"/post/[postId]\" ||\n    ctx.pathname === \"/messages\" ||\n    ctx.pathname === \"/search\";\n\n  if (!token) {\n    destroyCookie(ctx, \"token\");\n    protectedRoutes && redirectUser(ctx, \"/login\");\n  }\n  //\n  else {\n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx);\n    }\n\n    try {\n      const res = await axios.get(`${baseUrl}/api/auth`, {\n        headers: { Authorization: token }\n      });\n\n      const { user, userFollowStats } = res.data;\n\n      if (user) !protectedRoutes && redirectUser(ctx, \"/\");\n\n      pageProps.user = user;\n      pageProps.userFollowStats = userFollowStats;\n    } catch (error) {\n      destroyCookie(ctx, \"token\");\n      redirectUser(ctx, \"/login\");\n    }\n  }\n\n  return { pageProps };\n};\n\nexport default MyApp;\n"]},"metadata":{},"sourceType":"module"}