{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Admin/Documents/social/social_network/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Admin/Documents/social/social_network/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\social\\\\social_network\\\\pages\\\\[username].js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n// @ts-nocheck\nimport React, { useEffect, useState, useRef } from \"react\";\nimport io from \"socket.io-client\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport baseUrl from \"../utils/baseUrl\";\nimport { parseCookies } from \"nookies\";\nimport { Grid } from \"semantic-ui-react\";\nimport { NoProfilePosts, NoProfile } from \"../components/Layout/NoData\";\nimport CardPost from \"../components/Post/CardPost\";\nimport cookie from \"js-cookie\";\nimport { PlaceHolderPosts } from \"../components/Layout/PlaceHolderGroup\";\nimport ProfileMenuTabs from \"../components/Profile/ProfileMenuTabs\";\nimport ProfileHeader from \"../components/Profile/ProfileHeader\";\nimport Followers from \"../components/Profile/Followers\";\nimport Following from \"../components/Profile/Following\";\nimport UpdateProfile from \"../components/Profile/UpdateProfile\";\nimport Settings from \"../components/Profile/Settings\";\nimport { PostDeleteToastr } from \"../components/Layout/Toastr\";\n\nfunction ProfilePage(_ref) {\n  _s();\n\n  var _this = this;\n\n  var errorLoading = _ref.errorLoading,\n      profile = _ref.profile,\n      followersLength = _ref.followersLength,\n      followingLength = _ref.followingLength,\n      user = _ref.user,\n      userFollowStats = _ref.userFollowStats;\n  var router = useRouter();\n\n  var _useState = useState([]),\n      posts = _useState[0],\n      setPosts = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      showToastr = _useState3[0],\n      setShowToastr = _useState3[1];\n\n  var _useState4 = useState(\"profile\"),\n      activeItem = _useState4[0],\n      setActiveItem = _useState4[1];\n\n  var handleItemClick = function handleItemClick(clickedTab) {\n    return setActiveItem(clickedTab);\n  };\n\n  var _useState5 = useState(userFollowStats),\n      loggedUserFollowStats = _useState5[0],\n      setUserFollowStats = _useState5[1];\n\n  var ownAccount = profile.user._id === user._id;\n  if (errorLoading) return __jsx(NoProfile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 28\n    }\n  });\n  useEffect(function () {\n    var getPosts = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var username, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setLoading(true);\n                _context.prev = 1;\n                username = router.query.username;\n                _context.next = 5;\n                return axios.get(\"\".concat(baseUrl, \"/api/profile/posts/\").concat(username), {\n                  headers: {\n                    Authorization: cookie.get(\"token\")\n                  }\n                });\n\n              case 5:\n                res = _context.sent;\n                setPosts(res.data);\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                alert(\"Error Loading Posts\");\n\n              case 12:\n                setLoading(false);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 9]]);\n      }));\n\n      return function getPosts() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    getPosts();\n  }, [router.query.username]);\n  useEffect(function () {\n    showToastr && setTimeout(function () {\n      return setShowToastr(false);\n    }, 4000);\n  }, [showToastr]);\n  var socket = useRef();\n  useEffect(function () {\n    if (!socket.current) {\n      socket.current = io(baseUrl);\n    }\n\n    if (socket.current) {\n      socket.current.emit(\"join\", {\n        userId: user._id\n      });\n    }\n\n    return function () {\n      if (socket.current) {\n        socket.current.emit(\"disconnect\");\n        socket.current.off();\n      }\n    };\n  }, []);\n  return __jsx(React.Fragment, null, showToastr && __jsx(PostDeleteToastr, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 22\n    }\n  }), __jsx(Grid, {\n    stackable: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, __jsx(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, __jsx(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, __jsx(ProfileMenuTabs, {\n    activeItem: activeItem,\n    handleItemClick: handleItemClick,\n    followersLength: followersLength,\n    followingLength: followingLength,\n    ownAccount: ownAccount,\n    loggedUserFollowStats: loggedUserFollowStats,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }))), __jsx(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, __jsx(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, activeItem === \"profile\" && __jsx(React.Fragment, null, __jsx(ProfileHeader, {\n    profile: profile,\n    ownAccount: ownAccount,\n    loggedUserFollowStats: loggedUserFollowStats,\n    setUserFollowStats: setUserFollowStats,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }), loading ? __jsx(PlaceHolderPosts, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 19\n    }\n  }) : posts.length > 0 ? posts.map(function (post) {\n    return __jsx(CardPost, {\n      socket: socket,\n      key: post._id,\n      post: post,\n      user: user,\n      setPosts: setPosts,\n      setShowToastr: setShowToastr,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    });\n  }) : __jsx(NoProfilePosts, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 19\n    }\n  })), activeItem === \"followers\" && __jsx(Followers, {\n    user: user,\n    loggedUserFollowStats: loggedUserFollowStats,\n    setUserFollowStats: setUserFollowStats,\n    profileUserId: profile.user._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 15\n    }\n  }), activeItem === \"following\" && __jsx(Following, {\n    user: user,\n    loggedUserFollowStats: loggedUserFollowStats,\n    setUserFollowStats: setUserFollowStats,\n    profileUserId: profile.user._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }), activeItem === \"updateProfile\" && __jsx(UpdateProfile, {\n    Profile: profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 48\n    }\n  }), activeItem === \"settings\" && __jsx(Settings, {\n    newMessagePopup: user.newMessagePopup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 15\n    }\n  })))));\n}\n\n_s(ProfilePage, \"WMEKMxYpyniq0+NbnnKCoX9Pqxw=\", false, function () {\n  return [useRouter];\n});\n\n_c = ProfilePage;\n\nProfilePage.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ctx) {\n    var username, _parseCookies, token, res, _res$data, profile, followersLength, followingLength;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            username = ctx.query.username;\n            _parseCookies = parseCookies(ctx), token = _parseCookies.token;\n            _context2.next = 5;\n            return axios.get(\"\".concat(baseUrl, \"/api/profile/\").concat(username), {\n              headers: {\n                Authorization: token\n              }\n            });\n\n          case 5:\n            res = _context2.sent;\n            _res$data = res.data, profile = _res$data.profile, followersLength = _res$data.followersLength, followingLength = _res$data.followingLength;\n            return _context2.abrupt(\"return\", {\n              profile: profile,\n              followersLength: followersLength,\n              followingLength: followingLength\n            });\n\n          case 10:\n            _context2.prev = 10;\n            _context2.t0 = _context2[\"catch\"](0);\n            return _context2.abrupt(\"return\", {\n              errorLoading: true\n            });\n\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 10]]);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport default ProfilePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"sources":["C:/Users/Admin/Documents/social/social_network/pages/[username].js"],"names":["React","useEffect","useState","useRef","io","useRouter","axios","baseUrl","parseCookies","Grid","NoProfilePosts","NoProfile","CardPost","cookie","PlaceHolderPosts","ProfileMenuTabs","ProfileHeader","Followers","Following","UpdateProfile","Settings","PostDeleteToastr","ProfilePage","errorLoading","profile","followersLength","followingLength","user","userFollowStats","router","posts","setPosts","loading","setLoading","showToastr","setShowToastr","activeItem","setActiveItem","handleItemClick","clickedTab","loggedUserFollowStats","setUserFollowStats","ownAccount","_id","getPosts","username","query","get","headers","Authorization","res","data","alert","setTimeout","socket","current","emit","userId","off","length","map","post","newMessagePopup","getInitialProps","ctx","token"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport React, { useEffect, useState, useRef } from \"react\";\nimport io from \"socket.io-client\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport baseUrl from \"../utils/baseUrl\";\nimport { parseCookies } from \"nookies\";\nimport { Grid } from \"semantic-ui-react\";\nimport { NoProfilePosts, NoProfile } from \"../components/Layout/NoData\";\nimport CardPost from \"../components/Post/CardPost\";\nimport cookie from \"js-cookie\";\nimport { PlaceHolderPosts } from \"../components/Layout/PlaceHolderGroup\";\nimport ProfileMenuTabs from \"../components/Profile/ProfileMenuTabs\";\nimport ProfileHeader from \"../components/Profile/ProfileHeader\";\nimport Followers from \"../components/Profile/Followers\";\nimport Following from \"../components/Profile/Following\";\nimport UpdateProfile from \"../components/Profile/UpdateProfile\";\nimport Settings from \"../components/Profile/Settings\";\nimport { PostDeleteToastr } from \"../components/Layout/Toastr\";\n\nfunction ProfilePage({\n  errorLoading,\n  profile,\n  followersLength,\n  followingLength,\n  user,\n  userFollowStats\n}) {\n  const router = useRouter();\n\n  const [posts, setPosts] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [showToastr, setShowToastr] = useState(false);\n\n  const [activeItem, setActiveItem] = useState(\"profile\");\n  const handleItemClick = clickedTab => setActiveItem(clickedTab);\n\n  const [loggedUserFollowStats, setUserFollowStats] = useState(userFollowStats);\n\n  const ownAccount = profile.user._id === user._id;\n\n  if (errorLoading) return <NoProfile />;\n\n  useEffect(() => {\n    const getPosts = async () => {\n      setLoading(true);\n\n      try {\n        const { username } = router.query;\n        const res = await axios.get(`${baseUrl}/api/profile/posts/${username}`, {\n          headers: { Authorization: cookie.get(\"token\") }\n        });\n\n        setPosts(res.data);\n      } catch (error) {\n        alert(\"Error Loading Posts\");\n      }\n\n      setLoading(false);\n    };\n    getPosts();\n  }, [router.query.username]);\n\n  useEffect(() => {\n    showToastr && setTimeout(() => setShowToastr(false), 4000);\n  }, [showToastr]);\n\n  const socket = useRef();\n\n  useEffect(() => {\n    if (!socket.current) {\n      socket.current = io(baseUrl);\n    }\n\n    if (socket.current) {\n      socket.current.emit(\"join\", { userId: user._id });\n    }\n\n    return () => {\n      if (socket.current) {\n        socket.current.emit(\"disconnect\");\n        socket.current.off();\n      }\n    };\n  }, []);\n\n  return (\n    <>\n      {showToastr && <PostDeleteToastr />}\n\n      <Grid stackable>\n        <Grid.Row>\n          <Grid.Column>\n            <ProfileMenuTabs\n              activeItem={activeItem}\n              handleItemClick={handleItemClick}\n              followersLength={followersLength}\n              followingLength={followingLength}\n              ownAccount={ownAccount}\n              loggedUserFollowStats={loggedUserFollowStats}\n            />\n          </Grid.Column>\n        </Grid.Row>\n\n        <Grid.Row>\n          <Grid.Column>\n            {activeItem === \"profile\" && (\n              <>\n                <ProfileHeader\n                  profile={profile}\n                  ownAccount={ownAccount}\n                  loggedUserFollowStats={loggedUserFollowStats}\n                  setUserFollowStats={setUserFollowStats}\n                />\n\n                {loading ? (\n                  <PlaceHolderPosts />\n                ) : posts.length > 0 ? (\n                  posts.map(post => (\n                    <CardPost\n                      socket={socket}\n                      key={post._id}\n                      post={post}\n                      user={user}\n                      setPosts={setPosts}\n                      setShowToastr={setShowToastr}\n                    />\n                  ))\n                ) : (\n                  <NoProfilePosts />\n                )}\n              </>\n            )}\n\n            {activeItem === \"followers\" && (\n              <Followers\n                user={user}\n                loggedUserFollowStats={loggedUserFollowStats}\n                setUserFollowStats={setUserFollowStats}\n                profileUserId={profile.user._id}\n              />\n            )}\n\n            {activeItem === \"following\" && (\n              <Following\n                user={user}\n                loggedUserFollowStats={loggedUserFollowStats}\n                setUserFollowStats={setUserFollowStats}\n                profileUserId={profile.user._id}\n              />\n            )}\n\n            {activeItem === \"updateProfile\" && <UpdateProfile Profile={profile} />}\n\n            {activeItem === \"settings\" && (\n              <Settings newMessagePopup={user.newMessagePopup} />\n            )}\n          </Grid.Column>\n        </Grid.Row>\n      </Grid>\n    </>\n  );\n}\n\nProfilePage.getInitialProps = async ctx => {\n  try {\n    const { username } = ctx.query;\n    const { token } = parseCookies(ctx);\n\n    const res = await axios.get(`${baseUrl}/api/profile/${username}`, {\n      headers: { Authorization: token }\n    });\n\n    const { profile, followersLength, followingLength } = res.data;\n\n    return { profile, followersLength, followingLength };\n  } catch (error) {\n    return { errorLoading: true };\n  }\n};\n\nexport default ProfilePage;\n"]},"metadata":{},"sourceType":"module"}